{
  "checkpoint": {
    "save_every_n_epochs": 1
  },
  "data": {
    "global_variables": [
      "P",
      "T"
    ],
    "species_variables": [
      "H_evolution",
      "H2_evolution",
      "OH_evolution",
      "H2O_evolution",
      "CO_evolution",
      "CO2_evolution",
      "O_evolution",
      "CH4_evolution",
      "C2H2_evolution",
      "NH3_evolution",
      "N2_evolution",
      "HCN_evolution"
    ]
  },
  "dataset": {
    "preload_to_device": false,
    "windows_per_trajectory": 1
  },
  "model": {
    "activation": "gelu",
    "decoder_hidden": [
      512,
      512
    ],
    "dropout": 0.0,
    "dynamics_hidden": [
      512,
      512
    ],
    "dynamics_residual": true,
    "encoder_hidden": [
      512,
      512
    ],
    "latent_dim": 256,
    "mlp_only": true,
    "predict_delta": true,
    "predict_delta_log_phys": false,
    "softmax_head": false
  },
  "normalization": {
    "default_method": "log-standard",
    "epsilon": 1e-30,
    "globals_default_method": "standard",
    "methods": {},
    "min_std": 1e-12
  },
  "paths": {
    "model_dir": "models",
    "processed_data_dir": "data/processed",
    "raw_data_dir": "data/raw",
    "work_dir": "models/rollout_run"
  },
  "preprocessing": {
    "_comment_balanced_sampling": "Enable balanced sampling by setting source_trajectories_per_file>0 and samples_per_source_trajectory>0. Total samples = output_trajectories_per_file (or N*K if output<=0).",
    "_comment_filtering": "Reject source data below threshold or missing time keys",
    "_comment_limits": "Safety limits for sampling loop",
    "_comment_logging": "Log progress every N trajectories written",
    "_comment_resampling": "Each output trajectory has n_steps points spaced dt apart",
    "_comment_sampling": "Balanced mode: choose N good source trajectories and sample K chunks from each",
    "_comment_sharding": "How to split and shard the output trajectories",
    "anchor_first_chunk": true,
    "drop_below": 1e-30,
    "dt": 100.0,
    "log_every_n_attempts": 5000,
    "log_every_n_trajectories": 200,
    "max_chunk_attempts_per_source": 200,
    "max_chunks_per_source_trajectory": 50,
    "max_sampling_attempts_per_file": 200000,
    "max_source_selection_attempts": 1000000,
    "n_steps": 100,
    "output_trajectories_per_file": 5000,
    "overwrite": true,
    "pool_size": 20000,
    "samples_per_source_trajectory": 50,
    "seed": 1234,
    "shard_size": 1024,
    "source_trajectories_per_file": 20,
    "t_min": 0.001,
    "test_fraction": 0.1,
    "time_keys": [
      "t_time",
      "time",
      "t"
    ],
    "val_fraction": 0.1
  },
  "run_name": "rollout_run",
  "runtime": {
    "_comment": "Entrypoint controls (no CLI args). Set mode to 'train' or 'eval'. Optionally set checkpoint path (absolute or relative to this config).",
    "checkpoint": null,
    "mode": "train"
  },
  "system": {
    "seed": 1234
  },
  "training": {
    "accumulate_grad_batches": 1,
    "batch_size": 256,
    "burn_in_additive_noise_std": 0.0,
    "burn_in_loss_weight": 0.0,
    "burn_in_steps": 0,
    "curriculum": {
      "enabled": false,
      "ramp_epochs": 0,
      "start_steps": 1
    },
    "devices": 1,
    "enable_model_summary": true,
    "enable_progress_bar": false,
    "grad_clip": 0.0,
    "log_every_n_steps": 20000000,
    "loss": {
      "eps_phys": 1e-20,
      "lambda_phys": 1.0,
      "lambda_z": 0.1,
      "range_eps": 1e-06,
      "w_species_clamp": [
        0.5,
        2.0
      ]
    },
    "lr": 0.001,
    "max_epochs": 100,
    "num_sanity_val_steps": 0,
    "num_workers": 0,
    "persistent_workers": false,
    "pin_memory": true,
    "precision": "bf16-mixed",
    "prefetch_factor": 2,
    "progress_bar_refresh_rate": 1,
    "resume": false,
    "rollout_steps": 96,
    "scheduler": {
      "min_lr_ratio": 0.01,
      "name": "cosine_warmup",
      "total_steps": 0,
      "warmup_steps": 200
    },
    "teacher_forcing": {
      "decay_epochs": 0,
      "end": 0.0,
      "mode": "linear",
      "start": 1.0
    },
    "terminal_log_every_n_steps": 1000000,
    "terminal_log_on_epoch": true,
    "terminal_log_on_step": true,
    "val_burn_in_steps": 0,
    "weight_decay": 0.0001
  }
}
