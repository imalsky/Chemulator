2025-07-13 10:07:46 | INFO     | utils.utils - Logging system initialized
2025-07-13 10:07:46 | INFO     | __main__ - ================================================================================
2025-07-13 10:07:46 | INFO     | __main__ - Chemical Kinetics Neural Network Pipeline
2025-07-13 10:07:46 | INFO     | __main__ - Configuration: config/config.jsonc
2025-07-13 10:07:46 | INFO     | utils.utils - Random seed set to 42
2025-07-13 10:07:46 | INFO     | utils.hardware - Using Apple Silicon MPS device
2025-07-13 10:07:46 | WARNING  | utils.hardware - MPS backend has limited operator support
2025-07-13 10:07:46 | WARNING  | utils.hardware - torch.compile is disabled for MPS devices
2025-07-13 10:07:46 | WARNING  | utils.hardware - Disabling torch.compile for MPS device due to compatibility issues
2025-07-13 10:07:46 | INFO     | __main__ - Pipeline initialized with NPY shard format for high-performance data loading
2025-07-13 10:07:46 | INFO     | __main__ - Starting direct NPY shard creation from raw files...
2025-07-13 10:07:46 | INFO     | data.preprocessor - Processing 9 raw data files directly to NPY shards...
2025-07-13 10:07:46 | INFO     | data.preprocessor - Pre-normalization ENABLED - shards will contain normalized data
2025-07-13 10:07:46 | INFO     | data.preprocessor - Scanning files with 4 workers…
2025-07-13 10:08:06 | INFO     | data.preprocessor - Found 2,016,000 profiles × 100 timesteps
2025-07-13 10:08:06 | INFO     | data.preprocessor - Split sizes - Train: 1,411,200, Val: 302,400, Test: 302,400
2025-07-13 10:08:06 | INFO     | data.preprocessor - Creating NPY shards directly from raw files...
2025-07-13 10:08:06 | INFO     | data.preprocessor - Pre-normalization is ENABLED
2025-07-13 10:08:06 | INFO     | data.preprocessor - Pre-normalising shards – estimating statistics…
2025-07-13 10:08:06 | INFO     | data.normalizer - Calculating statistics from 1,411,200 rows in None
2025-07-13 10:08:06 | ERROR    | __main__ - Pipeline failed: Failed to compute normalisation statistics – aborting rather than fabricating data.
Traceback (most recent call last):
  File "/Users/imalsky/Desktop/Test/src/data/preprocessor.py", line 255, in _initialize_normalizer
    train_stats = normalizer.calculate_statistics(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/imalsky/Desktop/Test/src/data/normalizer.py", line 112, in calculate_statistics
    with h5py.File(data_file, "r", libver="latest") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/envs/nn/lib/python3.12/site-packages/h5py/_hl/files.py", line 539, in __init__
    name = filename_encode(name)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/envs/nn/lib/python3.12/site-packages/h5py/_hl/compat.py", line 25, in filename_encode
    filename = fspath(filename)
               ^^^^^^^^^^^^^^^^
TypeError: expected str, bytes or os.PathLike object, not NoneType

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/imalsky/Desktop/Test/src/main.py", line 332, in run
    self.preprocess_data()
  File "/Users/imalsky/Desktop/Test/src/main.py", line 168, in preprocess_data
    dataset_info = preprocessor.process_to_npy_shards()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/imalsky/Desktop/Test/src/data/preprocessor.py", line 211, in process_to_npy_shards
    shard_info = self._create_npy_shards_direct(timesteps, splits, file_profiles)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/imalsky/Desktop/Test/src/data/preprocessor.py", line 373, in _create_npy_shards_direct
    self._initialize_normalizer(timesteps, splits)
  File "/Users/imalsky/Desktop/Test/src/data/preprocessor.py", line 260, in _initialize_normalizer
    raise RuntimeError(
RuntimeError: Failed to compute normalisation statistics – aborting rather than fabricating data.
