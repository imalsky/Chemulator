2025-07-12 14:09:53 | INFO     | utils.utils - Logging system initialized
2025-07-12 14:09:53 | INFO     | __main__ - ================================================================================
2025-07-12 14:09:53 | INFO     | __main__ - Chemical Kinetics Neural Network Pipeline
2025-07-12 14:09:53 | INFO     | __main__ - Configuration: config/config.jsonc
2025-07-12 14:09:53 | INFO     | utils.utils - Random seed set to 42
2025-07-12 14:09:53 | INFO     | utils.hardware - Using Apple Silicon MPS device
2025-07-12 14:09:53 | WARNING  | utils.hardware - MPS backend has limited operator support
2025-07-12 14:09:53 | WARNING  | utils.hardware - torch.compile is disabled for MPS devices
2025-07-12 14:09:53 | WARNING  | utils.hardware - Disabling torch.compile for MPS device due to compatibility issues
2025-07-12 14:09:53 | INFO     | __main__ - NPY shard format enabled for high-performance data loading
2025-07-12 14:09:53 | INFO     | __main__ - Starting data preprocessing …
2025-07-12 14:09:53 | INFO     | data.preprocessor - Processing 9 raw data files...
2025-07-12 14:09:53 | INFO     | data.preprocessor - Scanning files with 4 workers…
2025-07-12 14:10:13 | INFO     | data.preprocessor - Found 2,016,000 profiles × 100 timesteps
2025-07-12 14:10:14 | INFO     | data.preprocessor - Split sizes - Train: 1,411,200, Val: 302,400, Test: 302,400
2025-07-12 14:10:14 | INFO     | data.preprocessor - Creating flattened dataset …
2025-07-12 14:22:50 | INFO     | data.preprocessor - Parsed 5/9 files (55.6 %)
2025-07-12 14:27:30 | INFO     | data.preprocessor - Parsed 9/9 files (100.0 %)
2025-07-12 14:27:34 | INFO     | data.preprocessor - Saved 139,653,063 train sample indices
2025-07-12 14:27:35 | INFO     | data.preprocessor - Saved 29,925,720 validation sample indices
2025-07-12 14:27:35 | INFO     | data.preprocessor - Saved 29,926,314 test sample indices
2025-07-12 14:27:35 | WARNING  | data.preprocessor - Wrote 199,505,097 rows < expected 199,584,000; resizing dataset to actual length
2025-07-12 14:27:35 | INFO     | data.preprocessor - Flattening complete – 199,505,097 rows in 1,041.5 s (191,547 rows s⁻¹)
2025-07-12 14:27:38 | INFO     | __main__ - Computing normalisation statistics …
2025-07-12 14:27:38 | INFO     | data.normalizer - Calculating statistics from 139,653,063 rows in data/processed/dataset.h5
2025-07-12 14:27:38 | INFO     | data.normalizer - Using reservoir size 10,000,000 for symlog quantile estimation (100 timesteps × 139653063 profiles)
2025-07-12 14:31:32 | INFO     | data.normalizer - Statistics ready in 231.4s
2025-07-12 14:31:33 | INFO     | __main__ - Pre-processing complete.
2025-07-12 14:31:33 | INFO     | __main__ - Converting HDF5 to NPY shards for optimized loading...
2025-07-12 14:31:33 | INFO     | data.preprocessor - Converting HDF5 → NPY shards
  input : data/processed/dataset.h5
  output: data/processed/npy_shards
2025-07-12 14:31:34 | INFO     | data.preprocessor -        train: 139,653,063 samples
2025-07-12 14:31:34 | INFO     | data.preprocessor -   validation: 29,925,720 samples
2025-07-12 14:31:34 | INFO     | data.preprocessor -         test: 29,926,314 samples
2025-07-12 14:31:34 | ERROR    | __main__ - Pipeline failed: 'memmap' object does not support the context manager protocol
Traceback (most recent call last):
  File "/Users/imalsky/Desktop/Test/src/main.py", line 341, in run
    self.preprocess_data()
  File "/Users/imalsky/Desktop/Test/src/main.py", line 224, in preprocess_data
    shard_info = pre.convert_h5_to_npy_shards(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/imalsky/Desktop/Test/src/data/preprocessor.py", line 247, in convert_h5_to_npy_shards
    with np.lib.format.open_memmap(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'memmap' object does not support the context manager protocol
