2025-07-12 20:01:10 | INFO     | utils.utils - Logging system initialized
2025-07-12 20:01:10 | INFO     | __main__ - ================================================================================
2025-07-12 20:01:10 | INFO     | __main__ - Chemical Kinetics Neural Network Pipeline
2025-07-12 20:01:10 | INFO     | __main__ - Configuration: config/config.jsonc
2025-07-12 20:01:10 | INFO     | utils.utils - Random seed set to 42
2025-07-12 20:01:10 | INFO     | utils.hardware - Using Apple Silicon MPS device
2025-07-12 20:01:10 | WARNING  | utils.hardware - MPS backend has limited operator support
2025-07-12 20:01:10 | WARNING  | utils.hardware - torch.compile is disabled for MPS devices
2025-07-12 20:01:10 | WARNING  | utils.hardware - Disabling torch.compile for MPS device due to compatibility issues
2025-07-12 20:01:10 | INFO     | __main__ - Pipeline initialized with NPY shard format for high-performance data loading
2025-07-12 20:01:10 | INFO     | __main__ - Starting direct NPY shard creation from raw files...
2025-07-12 20:01:10 | INFO     | data.preprocessor - Processing 9 raw data files directly to NPY shards...
2025-07-12 20:01:10 | INFO     | data.preprocessor - Scanning files with 4 workers…
2025-07-12 20:01:31 | INFO     | data.preprocessor - Found 2,016,000 profiles × 100 timesteps
2025-07-12 20:01:31 | INFO     | data.preprocessor - Split sizes - Train: 1,411,200, Val: 302,400, Test: 302,400
2025-07-12 20:01:31 | INFO     | data.preprocessor - Creating NPY shards directly from raw files...
2025-07-12 20:14:04 | INFO     | data.preprocessor - Processed 5/9 files (55.6%), 110,839,509 samples written
2025-07-12 20:18:40 | INFO     | data.preprocessor - Processed 9/9 files (100.0%), 199,505,097 samples written
2025-07-12 20:18:46 | INFO     | data.preprocessor - Saved 139,653,063 train sample indices
2025-07-12 20:18:47 | INFO     | data.preprocessor - Saved 29,925,720 validation sample indices
2025-07-12 20:18:48 | INFO     | data.preprocessor - Saved 29,926,314 test sample indices
2025-07-12 20:18:48 | INFO     | data.preprocessor - NPY shard creation complete – 199,505,097 samples in 1036.5s (192482 samples/s)
2025-07-12 20:18:50 | INFO     | data.preprocessor - Created metadata file: data/processed/dataset.h5
2025-07-12 20:18:51 | INFO     | __main__ - Computing normalization statistics...
2025-07-12 20:18:51 | INFO     | data.dataset - Train split: 139,653,063 samples (indices mmap-loaded)
2025-07-12 20:18:51 | INFO     | data.dataset - NPYDataset ready: 139,653,063 samples, 20 shards, normalized=False
2025-07-12 20:18:51 | INFO     | data.normalizer - Calculating statistics from 139,653,063 samples in NPY dataset
2025-07-12 20:19:21 | INFO     | data.normalizer - Progress: 1.5% (2,050,000/139,653,063 samples)
2025-07-12 20:19:51 | INFO     | data.normalizer - Progress: 2.9% (4,040,000/139,653,063 samples)
2025-07-12 20:20:21 | INFO     | data.normalizer - Progress: 4.3% (6,020,000/139,653,063 samples)
2025-07-12 20:20:51 | INFO     | data.normalizer - Progress: 5.7% (8,020,000/139,653,063 samples)
2025-07-12 20:21:21 | INFO     | data.normalizer - Progress: 7.2% (10,010,000/139,653,063 samples)
2025-07-12 20:21:52 | INFO     | data.normalizer - Progress: 8.6% (12,010,000/139,653,063 samples)
2025-07-12 20:22:22 | INFO     | data.normalizer - Progress: 10.0% (14,000,000/139,653,063 samples)
2025-07-12 20:22:52 | INFO     | data.normalizer - Progress: 11.5% (16,000,000/139,653,063 samples)
2025-07-12 20:23:22 | INFO     | data.normalizer - Progress: 12.9% (17,990,000/139,653,063 samples)
2025-07-12 20:23:52 | INFO     | data.normalizer - Progress: 14.3% (19,990,000/139,653,063 samples)
2025-07-12 20:24:22 | INFO     | data.normalizer - Progress: 15.7% (21,980,000/139,653,063 samples)
2025-07-12 20:24:52 | INFO     | data.normalizer - Progress: 17.2% (23,980,000/139,653,063 samples)
2025-07-12 20:25:22 | INFO     | data.normalizer - Progress: 18.6% (25,980,000/139,653,063 samples)
2025-07-12 20:25:52 | INFO     | data.normalizer - Progress: 20.0% (27,970,000/139,653,063 samples)
2025-07-12 20:26:23 | INFO     | data.normalizer - Progress: 21.5% (29,970,000/139,653,063 samples)
2025-07-12 20:26:53 | INFO     | data.normalizer - Progress: 22.9% (31,960,000/139,653,063 samples)
2025-07-12 20:27:23 | INFO     | data.normalizer - Progress: 24.3% (33,960,000/139,653,063 samples)
2025-07-12 20:27:53 | INFO     | data.normalizer - Progress: 25.7% (35,950,000/139,653,063 samples)
2025-07-12 20:28:23 | INFO     | data.normalizer - Progress: 27.2% (37,940,000/139,653,063 samples)
2025-07-12 20:28:53 | INFO     | data.normalizer - Progress: 28.6% (39,940,000/139,653,063 samples)
2025-07-12 20:29:23 | INFO     | data.normalizer - Progress: 30.0% (41,930,000/139,653,063 samples)
2025-07-12 20:29:53 | INFO     | data.normalizer - Progress: 31.5% (43,930,000/139,653,063 samples)
2025-07-12 20:30:23 | INFO     | data.normalizer - Progress: 32.9% (45,930,000/139,653,063 samples)
2025-07-12 20:30:53 | INFO     | data.normalizer - Progress: 34.3% (47,920,000/139,653,063 samples)
2025-07-12 20:31:23 | INFO     | data.normalizer - Progress: 35.7% (49,910,000/139,653,063 samples)
2025-07-12 20:31:53 | INFO     | data.normalizer - Progress: 37.2% (51,910,000/139,653,063 samples)
2025-07-12 20:32:23 | INFO     | data.normalizer - Progress: 38.6% (53,910,000/139,653,063 samples)
2025-07-12 20:32:53 | INFO     | data.normalizer - Progress: 40.0% (55,910,000/139,653,063 samples)
2025-07-12 20:33:23 | INFO     | data.normalizer - Progress: 41.5% (57,910,000/139,653,063 samples)
2025-07-12 20:33:54 | INFO     | data.normalizer - Progress: 42.9% (59,890,000/139,653,063 samples)
2025-07-12 20:34:24 | INFO     | data.normalizer - Progress: 44.3% (61,880,000/139,653,063 samples)
2025-07-12 20:34:54 | INFO     | data.normalizer - Progress: 45.7% (63,880,000/139,653,063 samples)
2025-07-12 20:35:24 | INFO     | data.normalizer - Progress: 47.2% (65,870,000/139,653,063 samples)
2025-07-12 20:35:54 | INFO     | data.normalizer - Progress: 48.6% (67,870,000/139,653,063 samples)
2025-07-12 20:36:24 | INFO     | data.normalizer - Progress: 50.0% (69,870,000/139,653,063 samples)
2025-07-12 20:36:54 | INFO     | data.normalizer - Progress: 51.5% (71,860,000/139,653,063 samples)
2025-07-12 20:37:24 | INFO     | data.normalizer - Progress: 52.9% (73,850,000/139,653,063 samples)
2025-07-12 20:37:54 | INFO     | data.normalizer - Progress: 54.3% (75,850,000/139,653,063 samples)
2025-07-12 20:38:25 | INFO     | data.normalizer - Progress: 55.7% (77,840,000/139,653,063 samples)
2025-07-12 20:38:55 | INFO     | data.normalizer - Progress: 57.2% (79,840,000/139,653,063 samples)
2025-07-12 20:39:25 | INFO     | data.normalizer - Progress: 58.6% (81,840,000/139,653,063 samples)
2025-07-12 20:39:55 | INFO     | data.normalizer - Progress: 60.0% (83,830,000/139,653,063 samples)
2025-07-12 20:40:25 | INFO     | data.normalizer - Progress: 61.5% (85,820,000/139,653,063 samples)
2025-07-12 20:40:55 | INFO     | data.normalizer - Progress: 62.9% (87,820,000/139,653,063 samples)
2025-07-12 20:41:25 | INFO     | data.normalizer - Progress: 64.3% (89,820,000/139,653,063 samples)
2025-07-12 20:41:55 | INFO     | data.normalizer - Progress: 65.7% (91,810,000/139,653,063 samples)
2025-07-12 20:42:25 | INFO     | data.normalizer - Progress: 67.2% (93,800,000/139,653,063 samples)
2025-07-12 20:42:55 | INFO     | data.normalizer - Progress: 68.6% (95,800,000/139,653,063 samples)
2025-07-12 20:43:26 | INFO     | data.normalizer - Progress: 70.0% (97,800,000/139,653,063 samples)
2025-07-12 20:43:56 | INFO     | data.normalizer - Progress: 71.5% (99,800,000/139,653,063 samples)
2025-07-12 20:44:26 | INFO     | data.normalizer - Progress: 72.9% (101,800,000/139,653,063 samples)
2025-07-12 20:44:56 | INFO     | data.normalizer - Progress: 74.3% (103,790,000/139,653,063 samples)
2025-07-12 20:45:26 | INFO     | data.normalizer - Progress: 75.7% (105,780,000/139,653,063 samples)
2025-07-12 20:45:56 | INFO     | data.normalizer - Progress: 77.2% (107,770,000/139,653,063 samples)
2025-07-12 20:46:26 | INFO     | data.normalizer - Progress: 78.6% (109,770,000/139,653,063 samples)
2025-07-12 20:46:56 | INFO     | data.normalizer - Progress: 80.0% (111,760,000/139,653,063 samples)
2025-07-12 20:47:26 | INFO     | data.normalizer - Progress: 81.5% (113,750,000/139,653,063 samples)
2025-07-12 20:47:56 | INFO     | data.normalizer - Progress: 82.9% (115,750,000/139,653,063 samples)
2025-07-12 20:48:26 | INFO     | data.normalizer - Progress: 84.3% (117,750,000/139,653,063 samples)
2025-07-12 20:48:56 | INFO     | data.normalizer - Progress: 85.7% (119,740,000/139,653,063 samples)
2025-07-12 20:49:26 | INFO     | data.normalizer - Progress: 87.2% (121,740,000/139,653,063 samples)
2025-07-12 20:49:56 | INFO     | data.normalizer - Progress: 88.6% (123,730,000/139,653,063 samples)
2025-07-12 20:50:27 | INFO     | data.normalizer - Progress: 90.0% (125,720,000/139,653,063 samples)
2025-07-12 20:50:57 | INFO     | data.normalizer - Progress: 91.5% (127,720,000/139,653,063 samples)
2025-07-12 20:51:27 | INFO     | data.normalizer - Progress: 92.9% (129,710,000/139,653,063 samples)
2025-07-12 20:51:57 | INFO     | data.normalizer - Progress: 94.3% (131,710,000/139,653,063 samples)
2025-07-12 20:52:27 | INFO     | data.normalizer - Progress: 95.7% (133,700,000/139,653,063 samples)
2025-07-12 20:52:57 | INFO     | data.normalizer - Progress: 97.1% (135,670,000/139,653,063 samples)
2025-07-12 20:53:28 | INFO     | data.normalizer - Progress: 98.6% (137,660,000/139,653,063 samples)
2025-07-12 20:53:58 | INFO     | data.normalizer - Progress: 100.0% (139,640,000/139,653,063 samples)
2025-07-12 20:53:58 | INFO     | data.normalizer - Statistics calculated in 2106.6s
2025-07-12 20:53:58 | INFO     | __main__ - Pre-processing complete.
2025-07-12 20:53:59 | INFO     | __main__ - Starting model training...
2025-07-12 20:53:59 | INFO     | __main__ - Model: DEEPONET
2025-07-12 20:53:59 | INFO     | __main__ - Parameters: 5,044,878
2025-07-12 20:53:59 | INFO     | __main__ - Creating NPY shard datasets for high-performance loading...
2025-07-12 20:53:59 | INFO     | data.dataset - Train split: 139,653,063 samples (indices mmap-loaded)
2025-07-12 20:53:59 | INFO     | data.dataset - NPYDataset ready: 139,653,063 samples, 20 shards, normalized=True
2025-07-12 20:53:59 | INFO     | data.dataset - Validation split: 29,925,720 samples (indices mmap-loaded)
2025-07-12 20:53:59 | INFO     | data.dataset - NPYDataset ready: 29,925,720 samples, 20 shards, normalized=True
2025-07-12 20:53:59 | INFO     | data.dataset - Test split: 29,926,314 samples (indices mmap-loaded)
2025-07-12 20:53:59 | INFO     | data.dataset - NPYDataset ready: 29,926,314 samples, 20 shards, normalized=True
2025-07-12 20:53:59 | INFO     | __main__ - NPY Dataset info: {'format': 'npy_shards', 'n_shards': 20, 'samples_per_shard': 10000000, 'total_samples': 139653063, 'split': 'train', 'normalized': True}
2025-07-12 20:53:59 | INFO     | data.dataset - DataLoader created with 24 workers, prefetch_factor=4
2025-07-12 20:53:59 | INFO     | data.dataset - DataLoader created with 24 workers, prefetch_factor=4
2025-07-12 20:53:59 | INFO     | data.dataset - DataLoader created with 24 workers, prefetch_factor=4
2025-07-12 20:53:59 | INFO     | training.trainer - Reducing DataLoader workers from 24 ➔ 6
2025-07-12 20:54:00 | INFO     | training.trainer - Optimizer: AdamW with lr=5.00e-04, weight_decay=1.00e-05
2025-07-12 20:54:00 | INFO     | training.trainer - Scheduler: cosine
2025-07-12 20:54:00 | INFO     | training.trainer - Loss function: huber
2025-07-12 20:54:00 | WARNING  | training.trainer - MPS doesn't support bfloat16, using float16 instead
2025-07-12 20:54:00 | INFO     | training.trainer - GradScaler disabled on MPS (not supported)
2025-07-12 20:54:00 | INFO     | training.trainer - AMP enabled with dtype=float16 on mps device
2025-07-12 20:54:00 | INFO     | training.trainer - Starting training...
2025-07-12 20:54:00 | INFO     | training.trainer - Train batches: 1065
2025-07-12 20:54:00 | INFO     | training.trainer - Val batches: 228
2025-07-12 20:55:06 | INFO     | training.trainer - Epoch 001   0.1%  Loss 8.2015e-02
2025-07-12 21:02:48 | INFO     | training.trainer - Epoch 001   0.7%  Loss 1.2027e-01
2025-07-12 21:08:05 | INFO     | training.trainer - Epoch 001   1.2%  Loss 1.3227e-01
2025-07-12 21:15:07 | INFO     | training.trainer - Epoch 001   1.8%  Loss 1.3200e-01
2025-07-12 21:21:00 | INFO     | training.trainer - Epoch 001   2.3%  Loss 1.2336e-01
2025-07-12 21:29:45 | INFO     | training.trainer - Epoch 001   2.9%  Loss 1.0702e-01
2025-07-12 21:39:49 | INFO     | training.trainer - Epoch 001   3.5%  Loss 9.4358e-02
2025-07-12 21:50:01 | INFO     | training.trainer - Epoch 001   4.0%  Loss 8.7618e-02
2025-07-12 22:04:17 | INFO     | training.trainer - Epoch 001   4.6%  Loss 9.0045e-02
2025-07-12 22:17:32 | INFO     | training.trainer - Epoch 001   5.2%  Loss 7.7167e-02
2025-07-12 22:24:10 | INFO     | training.trainer - Epoch 001   5.7%  Loss 6.7176e-02
2025-07-12 22:35:41 | INFO     | training.trainer - Epoch 001   6.3%  Loss 4.2258e-02
