2025-07-13 11:50:31 | INFO     | utils.utils - Logging system initialized
2025-07-13 11:50:31 | INFO     | __main__ - ================================================================================
2025-07-13 11:50:31 | INFO     | __main__ - Chemical Kinetics Neural Network Pipeline
2025-07-13 11:50:31 | INFO     | __main__ - Configuration: config/config.jsonc
2025-07-13 11:50:31 | INFO     | utils.utils - Random seed set to 42
2025-07-13 11:50:31 | INFO     | utils.hardware - Using Apple Silicon MPS device
2025-07-13 11:50:31 | WARNING  | utils.hardware - MPS backend has limited operator support
2025-07-13 11:50:31 | WARNING  | utils.hardware - torch.compile is disabled for MPS devices
2025-07-13 11:50:31 | WARNING  | utils.hardware - Disabling torch.compile for MPS device due to compatibility issues
2025-07-13 11:50:31 | INFO     | __main__ - Pipeline initialized with NPY shard format for high-performance data loading
2025-07-13 11:50:31 | INFO     | __main__ - Starting direct NPY shard creation from raw files...
2025-07-13 11:50:31 | INFO     | data.preprocessor - Processing 9 raw data files directly to NPY shards...
2025-07-13 11:50:31 | INFO     | data.preprocessor - Pre-normalization ENABLED - shards will contain normalized data
2025-07-13 11:50:31 | INFO     | data.preprocessor - Scanning files with 4 workers…
2025-07-13 11:50:50 | INFO     | data.preprocessor - Found 2,016,000 profiles × 100 timesteps
2025-07-13 11:50:51 | INFO     | data.preprocessor - Split sizes - Train: 1,411,200, Val: 302,400, Test: 302,400
2025-07-13 11:50:51 | INFO     | data.preprocessor - Creating NPY shards directly from raw files...
2025-07-13 11:50:51 | INFO     | data.preprocessor - Loading normalization statistics for pre-normalized shards...
2025-07-13 11:50:51 | WARNING  | data.preprocessor - Normalization file data/processed/normalization.json not found. Creating raw shards; normalization will be applied later if needed.
2025-07-13 12:03:37 | INFO     | data.preprocessor - Processed 5/9 files (55.6%), 110,839,509 samples written
2025-07-13 12:08:29 | INFO     | data.preprocessor - Processed 9/9 files (100.0%), 199,505,097 samples written
2025-07-13 12:08:33 | INFO     | data.preprocessor - Saved 139,653,063 train sample indices
2025-07-13 12:08:34 | INFO     | data.preprocessor - Saved 29,925,720 validation sample indices
2025-07-13 12:08:35 | INFO     | data.preprocessor - Saved 29,926,314 test sample indices
2025-07-13 12:08:35 | INFO     | data.preprocessor - NPY shard creation complete (raw) – 199,505,097 samples in 1064.1s (187482 samples/s)
2025-07-13 12:08:36 | INFO     | data.preprocessor - Created metadata file: data/processed/dataset.h5
2025-07-13 12:08:38 | INFO     | __main__ - Computing normalization statistics...
2025-07-13 12:08:38 | INFO     | data.dataset - Train split: 139,653,063 samples (indices mmap-loaded)
2025-07-13 12:08:38 | INFO     | data.dataset - NPYDataset ready: 139,653,063 samples, 200 shards, data=pre-normalized, normalize_on_load=False
2025-07-13 12:08:38 | INFO     | data.normalizer - Calculating statistics from 139,653,063 samples in NPY dataset
2025-07-13 12:08:38 | INFO     | data.normalizer - Using reservoir size 10,000 for symlog quantile estimation (100 timesteps × 140 profiles)
2025-07-13 12:09:28 | INFO     | data.normalizer - Progress: 34.1% (47,580,588/139,653,063 samples)
2025-07-13 12:09:58 | INFO     | data.normalizer - Progress: 72.7% (101,543,013/139,653,063 samples)
2025-07-13 12:10:23 | INFO     | data.normalizer - Statistics calculated in 84.9s
2025-07-13 12:10:24 | INFO     | __main__ - Applying normalization to NPY shards...
2025-07-13 12:10:24 | INFO     | data.preprocessor - Normalizing <data.normalizer.NormalizationHelper object at 0x105407b90> shards...
2025-07-13 12:10:24 | ERROR    | __main__ - Pipeline failed: 'NormalizationHelper' object cannot be interpreted as an integer
Traceback (most recent call last):
  File "/Users/imalsky/Desktop/Test/src/main.py", line 341, in run
    self.preprocess_data()
  File "/Users/imalsky/Desktop/Test/src/main.py", line 205, in preprocess_data
    preprocessor._normalize_shards(norm_helper)
  File "/Users/imalsky/Desktop/Test/src/data/preprocessor.py", line 500, in _normalize_shards
TypeError: 'NormalizationHelper' object cannot be interpreted as an integer
